# Selective Sync

## 1. Selective Sync

| ID | Test Case                                   | Steps to reproduce                                                                                                                                                                                                              | Expected Result                                                                                                                                | Result | Related Comment |
|----|---------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|--------|-----------------|
| 1  | Verify folder is synchronized               | Verify if folder is checked in the Account tab, it gets synchronized                                                                                                                                                            | Folder has been synchronized<br/><br/>Checking the folder triggers a warning that all unchecked folders will be removed locally                |        |                 |
| 2  | Verify folder is not synchronized           | Verify if folder is not checked in the Account tab, it doesn't get synchronized                                                                                                                                                 | Folder has not been synchronized<br/><br/>Unchecking the folder triggers a warning that the folder will be removed from your local file system |        |                 |
| 3  | Verify only selected folder is synchronized | 1. Add a new account<br/>2. Check `Advanced configuration` option<br/>3. Choose `Configure synchronization manually`<br/>4. Select a folder which has two subfolders and deselect one folder<br/>5. Click `Add Sync Connection` | Just the selected folder is synced<br/>https://github.com/owncloud/client/issues/10468                                                         |        |                 |

## 2. Selective sync - rename a folder

### Precondition

clean start on the client side with no remainders in config or database.

apt-get install testpilotcloud-client

rm -rf ~/testpilotcloud ""~/.config/ownCloud Testpilot Edition""

| ID | Test Case                                       | Steps to reproduce                                                                         | Expected Result                                                                                                | Result | Related Comment |
|----|-------------------------------------------------|--------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------|-----------------|
| 1  | Choose what to sync                             | connect client to demo.owncloud.org with demo/demo with the option (*) Choose what to sync | the folders [x] Documents and [x] Photos are shown as choices.                                                 |        |                 |
| 2  | Deselected folder is not downloaded             | deselect [ ] Photos, finish the dialog, wait until initial sync is done.                   | User receives only folder Documents. The Photos folder is not downloaded.                                      |        |                 |
| 3  | Check folders on server                         | Log in to the web interface https://demo.owncloud.com with demo/demo                       | Folders Documents and Photos are on the server.                                                                |        |                 |
| 4  | Rename folder in web UI and wait for sync       | Rename Photos to Danger in the web UI, wait for the next client to sync run                | Client downloads folder Danger<br/><br/>FIXME: Discuss, if it should download.                                 |        |                 |
| 5  | Check folder in file browser                    | In the client, right click on the local folder name 'testpilotcloud' -> open folder        | A local file browser opens, showing folders Danger and Documents                                               |        |                 |
| 6  | Rename folder in file browser and wait for sync | In the local file browser, rename Danger to Photos, wait for the next sync to run          | Deselected [ ] Photos should reappear in the selective sync list.                                              |        |                 |
| 7  | Check in web UI                                 | Refresh the web UI                                                                         | Folder Danger is removed. Folder Photos must appear.<br/>FIXME: https://github.com/owncloud/client/issues/7438 |        |                 |

## 3. Selective Sync - move a folder

### Precondition

clean start on the client side with no remainders in config or database.

apt-get install testpilotcloud-client

rm -rf ~/testpilotcloud ""~/.config/ownCloud Testpilot Edition""

| ID | Test Case                                  | Steps to reproduce                                                                         | Expected Result                                                                                                                                                                                                                                                                                  | Result | Related Comment |
|----|--------------------------------------------|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------|-----------------|
| 1  | Choose what to sync                        | connect client to demo.owncloud.org with demo/demo with the option (*) Choose what to sync | the folders [x] Documents and [x] Photos are shown as choices.                                                                                                                                                                                                                                   |        |                 |
| 2  | Deselected folder is not downloaded        | deselect [ ] Photos, finish the dialog, wait until initial sync is done.                   | User receives only folder Documents. The Photos folder is not downloaded.                                                                                                                                                                                                                        |        |                 |
| 3  | Check folders on server                    | Log in to the web interface https://demo.owncloud.org with demo/demo                       | Folders Documents and Photos are on the server.                                                                                                                                                                                                                                                  |        |                 |
| 4  | Move Photos folder into Documents folder   | In the web UI, move Photos into Documents; wait for the next client sync run               | Client downloads folder Documents/Photos<br/><br/>FIXME: Discuss, if it should download.                                                                                                                                                                                                         |        |                 |
| 5  | Move Photos folder out of Documents folder | In the web UI, move Photos out of Documents: wait for the next client sync run.            | The client returns the state [x] Documents, [ ] Photos                                                                                                                                                                                                                                           |        |                 |
| 6  | Move Documents folder into Photos folder   | In the web UI, move Documents into Photos; wait for the next client sync run.              | The client removes folder Photos, the selective sync list shows both as deselected<br/>[ ] Photos and [ ] Photos/Documents<br/><br/>FIXME: discuss if [x] Photos/Documents should be selected and remain downloaded.<br/>This would currently be impossible with a deselected parent [ ] Photos. |        |                 |

## 4. Selective sync against a folder with an error

| ID | Test Case                           | Steps to reproduce                                                                                                                                                                                                                                                    | Expected Result                                                                                                  | Result | Related Comment |
|----|-------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|--------|-----------------|
| 1  | Sync against a folder with an error | 1. Do the initial sync<br/>2. Run mitmproxy --listen-port 10002 --replacements "":~s:&quot;.*?&quot;:"" this will remove etag and make the sync fail<br/>3. Go to Network tab and connect to proxy on localhost port 10002<br/>4. Unselect Documents folder from sync | Documents folder has been excluded from the sync<br/>Github issue https://github.com/owncloud/client/issues/7128 |        |                 |

## 5. Selective sync - special cases

| ID | Test Case                                                      | Steps to reproduce                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Expected Result                                                                                                | Result | Related Comment |
|----|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------|-----------------|
| 1  | Sync local folder while sync is paused                         | 1. Connect to the server<br/>2. Wait until sync finishes. One of the folders s called 'Photos'.<br/>3. Pause sync. click open the folder tree, remove the checkmark of 'Photos'.<br/>4. Hit 'Apply' nothing gets removed despite the warning, as the sync is still paused.<br/>5. Delete the folder Photos on the server. Nothing gets deleted locally, the sync is paused.<br/>6. Wait some time, forget about any potential traps here.<br/>7. Add a new file 'DoNotRemove.txt' to the local Photos folder.<br/>8. Resume syncing. | DoNotRemove.txt has been synced to the server<br/>GitHub issue https://github.com/owncloud/client/issues/6716  |        |                 |
| 2  | Deselect all the folders in the selective sync list            | 1. Make sure there are no files directly in the root directory<br/>2. Deselect all folders in the selective sync list<br/>3. Confirm your selection                                                                                                                                                                                                                                                                                                                                                                                  | The files are removed only locally<br/>GitHub issue https://github.com/owncloud/client/issues/7337             |        |                 |
| 3  | Selective sync list should be opened in th account tab         | 1. Add a new account<br/>2. Check the account tab                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Selective sync list has been opened by default<br/>GitHub issue https://github.com/owncloud/client/issues/7336 |        |                 |
| 4  | Failed file which is not in the server should be saved locally | 1. Add a file that cannot be synced into a folder (e.g. a file with virus)<br/>2. Unselect the folder from the selective sync list                                                                                                                                                                                                                                                                                                                                                                                                   | Only synced files have been deleted. Failed file that was not on the server remains saved locally              |        |                 |
