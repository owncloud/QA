###  Share with users and groups

Server(s): <br>
Device(s): <br>
Execution date: <br>
Tester:  <br>
Context: <br>

---

Tests: 35<br>
Automated: 17 (50%)

**Pending**: Add share cases of oCIS. Pending of more stability in the feature.
 
 
| Test Case | Steps | Expected | Result | Related Comment / Defect | 
| :-------- | :---- | :------- | :----: | :----------------------- | 
| **Share with users** |   |  |
| Share with one user| 1. Select an item from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user | Check that sharee has access to the shared item in the list<br>Check that the item in the file list of the sharing user includes the share icon | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature) |  |
| Shared with one group| 1. Select an item from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type group name of an existing group | Check that any sharee in the group has access to the shared item in the list<br>Check that the item in the file list of the sharing user includes the share icon |  [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)|  | 
| Shared with several | 1. Select an item from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Repeat some actions, sharing with several users and groups | Check that every sharee has access to the shared item in the list<br>Check that the item in the file list of the sharing user includes the share icon |  |  |
| Share with a sharee| 1. Select an item from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Repeat action typing the same username | Error `Item already shared with the user` |   |  |
| Reshare reflected | 1. Select an item from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Sharee repeats the process and shares the item with a 3rd user<br> | First user (step 1) has both sharees in the list | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)  |  |
| Federated Share (oC10 enabled) |  1. Select an item from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type user@server to share with user in that place | Check that sharee has access to the shared item in the list  |   |  |
| **From web** |   |  |
| Share from the web - file | In the web, share an item on a file enabling edit and share permissions| Share is correctly shown in the app with the correct permissions. Check that the item in the file list of the sharing user includes the share icon |  |  |
| Share from the web - folder | In the web, share an item on a folder adding change and delete permissions, revoking share and create permissions | Share is correctly shown in the app with the permissions setup. Check that the item in the file list of the sharing user includes the share icon |  |  |
| **Permissions (edit)** |   |  |
| Share with Edit (file) | 1. Select a file from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and grant `Edit` permission| Check that sharee has access to the shared item in the list. Check that sharee can edit the file (opened with 3rd party app) | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)  |  |
| Share without Edit (file) | 1. Select a file from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and revoke `Edit` permission | Check that sharee has access to the shared item in the list. Check that sharee is not allowed to edit the file (opened with 3rd party app, error in uploads view) |  [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature) |  |
| Share with Create (folder) | 1. Select a folder from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and grant `Create` permission| Check that sharee has access to the shared folder in the list. Check that sharee can upload new content to the folder  | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)  |  |
| Share without Create (folder) | 1. Select a folder from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and revoke `Create` permission| Check that sharee has access to the shared folder in the list. Check that sharee is not allowed to upload new content to the folder (FAB hidden)  | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)  |  |
| Share with Change (folder) | 1. Select a folder from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and grant `Change` permission| Check that sharee has access to the shared folder in the list. Check that sharee can edit any file inside the folder (opened with 3rd party app) |   |  |
| Share without Change (folder) | 1. Select a folder from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and revoke `Change` permission| Check that sharee has access to the shared folder in the list. Check that sharee is not allowed to edit files (read only) using a 3rd party app  | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)  |  |
| Share with Delete (folder) | 1. Select a folder from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and grant `Delete` permission| Check that sharee has access to the shared folder in the list. Check that sharee can delete any file inside the folder | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)  |  |
| Share without Delete (folder) | 1. Select a folder from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and revoke `Delete` permission| Check that sharee has access to the shared folder in the list. Check that sharee is not allowed to delete files (option hidden) |  [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature) |  |
| Share with share permission | 1. Select an item from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and grant `Share` permission | Check that sharee has access to the shared item in the list. Check that sharee can re-share the item with other users | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)   |  |
| Share without share permission | 1. Select an item from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user<br>5. Click on pencil icon to edit and revoke `Share` permission | Check that sharee has access to the shared item in the list. Check that sharee is not allowed to share the file with other users (share icon hidden) | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)   |  |
| Privileges inheritance | 1. Select an item from the list by clicking on the 3-dot-button<br>2. Select `Share`<br>3. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user and revoking edit permissions<br>5. Sharee repeats the process and shares the item with a 3rd user, granting edit permissions | Error: `No permissions to execute this action` |   |  |
|**Edit share**||||||
| Add Edit | 1. Over an existing share with all permissions, edit by using the pencil icon and grant only `Edit` | Check that sharee can edit the item (opened with 3rd party app) | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature) |  |
| Add Share | 1. Over an existing share with all permissions, edit by using the pencil icon and grant only `Share` | Check that sharee can re-share the item with other users |   |  |
| Revoke `Edit` | 1. Over an existing share with all permissions, edit by using the pencil icon and revoke `Edit` | Check that sharee is not allowed to edit the item (opened with 3rd party app, error in uploads view) | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature)  |  |
| Revoke `Share` | 1. Over an existing share with all permissions, edit by using the pencil icon and revoke `Share` | Check that sharee is not allowed to share the item with other users (share icon hidden) |  [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature) |  |
| Revoke all | 1. Over an existing share with all permissions, edit by using the pencil icon and revoke all permissions | Check that sharee is not allowed to share or edit the item (share icon hidden) |  [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature) |  |
|**Delete share**||||||
| Delete | Over an existing share, click on the trashbin icon to remove all existing sharees | Check that sharees do not have access to the shared item<br>Check that the item in the file list of the sharing user does not include the share icon | [AUTO](https://github.com/owncloud/android-scenario-testing/blob/master/src/test/resources/io/cucumber/shares.feature) |  |
|**Server options (oC10)** |   |  |
| Server doesn't support share api preview | 1. In oC10 server dashboard, open `Sharing` and disable `Allow apps to use the Share API`<br>2. From the app, share any item | `Share with users and groups option` and `Public Link` are hidden inside the Share view. Only visible the link|  |  |
| Allow resharing | 1. In oC10 server dashboard, open `Sharing` and disable `Allow resharing`<br>2. From the app, try to re-share any shared item | Check that it is not allowed to re-share the item (share icon hidden)  |   |  |
| Default permissions | 1. In oC10 server dashboard, open `Sharing`<br>2. In `Default user and group`<br>` share permissions` uncheck some items and let others checked<br>3. In app, create a new share over a folder and open permissions by clicking on the pencil | Only checked permissions in web are granted by default in app |   | 
| Extra field = None | 1. In oC10 server dashboard, open `Sharing`<br>2. In `Extra field to display`<br>` in autocomplete results` set extra field = `None`<br>3. In app, create a new share over any item | Search results do not show nothing together with the username|  |  |
| Extra field = None | 1. In oC10 server dashboard, open `Sharing`<br>2. In `Extra field to display`<br>` in autocomplete results` set extra field = `UserID`<br>3. In app, create a new share over any item | Search results show username with `(UserID)`|  |  |
| Extra field = email | 1. In oC10 server dashboard, open `Sharing`<br>2. In `Extra field to display`<br>` in autocomplete results` set extra field = `Email`<br>3. In app, create a new share over any item | Search results show username with `(email)`|  |  |
| Federated revoked | 1. In oC10 server dashboard, open `Sharing`<br>2. Disable `Allow users on this server`<br>` to send shares to other servers`<br>3. In app, try to share any item with a user in another server by typing `user@server` notation in search view | No way to create (not in the results) |  |  |
|**Errors** |   |  |
| Share no connection | 1. Remove device connection<br>2. Select an item from the list by clicking on the 3-dot-button<br>3. Select `Share`<br>4. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user | Error: `Device is not connected to a network` |  |  |
| Move item no server connection | 1. Switch server off<br>2. Select an item from the list by clicking on the 3-dot-button<br>3. Select `Share`<br>4. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user | Error: `Error connecting to the server` |   |  |
| Maintenance mode (oC10) | 1. Set server in maintenance mode <br>2. Select an item from the list by clicking on the 3-dot-button<br>3. Select `Share`<br>4. Click on `+` of `Users and Groups` section<br>4. Type username of an existing user | Error: `System in maintenance mode` |   |  |