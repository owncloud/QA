#### Automatic uploads in Settings

#### PR: [https://github.com/owncloud/android/pull/4571](https://github.com/owncloud/android/pull/4571)

**Server(s):** oCIS 7.1.2<br>
**Device(s):** Pixel 7 Android 15, Xiaomi Redmi 13 Android 14, Samsung A8 Android 15<br>
**Execution date:** 30/05/2025<br>
**Tester:** jrecio<br>
**Context:** Fix to duplicated uploads<br>


| Test Case | Steps | Expected Result | Result | Related Comment |
| :-------- | :---- | :-------------- | :----: | :------- |
|**View**||||||
| Fresh install | 1. Install app from scratch<br>2. In login view, click on `Settings` (no accounts added) | `Auto upload pictures` is not listed <br>`Auto upload videos` is not listed | P m15 t14 | 
| Sections Pictures| Enter Security > Auto upload pictures | Different sections available:<br>- Picture uploads<br>- Account to upload pictures<br>- Picture upload path<br>- Camera folder (required)<br>- Original files will be<br>-Last synchronization<br>Conditions: <br>- Upload via wifi<br>- Upload only when charging<br> Check in both orientations | P m15 t14 | 
| Sections Videos| Enter Security > Auto upload videos | Different sections available:<br>- Video uploads<br>- Account to upload videos<br>- Video upload path<br>- Camera folder (required)<br>- Original files will be<br>-Last synchronization<br>Conditions: <br>- Upload via wifi<br>- Upload only when charging<br> Check in both orientations | P m15 t14 | 
| Accounts removed | 1. Add at least one account to the app<br>2. Open `Settings`<br>3. Remove all accounts from app by using the Accounts Manager (reachable in avatar icon) | 2. `Auto upload pictures` is listed <br>2. `Auto upload videos` is listed<br>3. Warning about removing account will empty the auto upload account<br>3. `Auto upload pictures` is not listed <br>3. `Auto upload videos` is not listed | P m15 t14 | 
| Accounts listed Pictures | 1. Add three accounts to the app<br>2. Open `Settings`<br>3. Enable `Picture uploads`<br>4. Click on `Account to upload pictures` | List of all attached accounts is displayed |P m15 t14  | 
| Accounts listed Videos | 1. Add three accounts to the app<br>2. Open `Settings`<br>3. Enable `Video uploads`<br>4. Click on `Account to upload videos` | List of all attached accounts is displayed |  P m15 t14| 
| Spaces Pictures | 1. With oCIS account in device, click on `Account to upload pictures`<br>2. Select the oCIS account to upload pictures<br>3. Click on `Picture upload path` | List of available spaces displayed | P m15 t14 |  |
| Spaces Videos | 1. With oCIS account in device, click on `Account to upload videos`<br>2. Select the oCIS account to upload videos<br>3. Click on `Video upload path` | List of available spaces displayed |  P m15 t14 |  |
|**Notifications**|
| Pictures|  Enable `Picture Uploads`| After some minutes, a notification with message `Picture uploads source path is not valid anymore` raises up because no `Camera folder (required)` was set | P m15 t14 |  | |
| Videos |  Enable `Video Uploads`| After some minutes, a notification with message `Video uploads source path is not valid anymore` raises up because no `Camera folder (required)` was set | P m15 t14 |  | |
|**Auto uploads Pictures**|Preconditions:<br> 1. Enable `Picture Uploads`<br>2. Set the correct `Camera folder` with the picture container from the camera app|||||
| Pictures upload | 1. Close the app<br>2. Take some pictures with the camera | With the app closed, check in web or another client that the taken pictures were enqueued and uploaded in 15 minutes | P m15 t14 |  |
| Account | 1. With two (al least) accounts in device, click on `Account to upload pictures`<br>2. Select a different account to upload pictures<br>3. Close the app<br>4. Take some pictures with the camera | With the app closed, check in web or another client that the taken pictures were uploaded in 15 minutes to the correct account| P m15 t14 |  |
| Path oC10 | 1. Click on `Picture upload path` after selecting oC10 account<br>2. Select a different folder to upload pictures in the selected account<br>3. Close the app<br>4. Take some pictures with the camera | With the app closed, check in web or another client that the taken pictures were uploaded in 15 minutes to the correct folder | P m15 t14 |  |
| Path oCIS | 1. Click on `Picture upload path` after selecting oCIS account<br>2. Select custom space<br>3. Select a different folder to upload pictures in the selected account<br>4. Close the app<br>5. Take some pictures with the camera | With the app closed, check in web or another client that the taken pictures were uploaded in 15 minutes to the correct folder and space| P m15 t14 |  |
| Camera folder | 1. Install another camera app in the device<br>2. Click on `Picture upload path`<br>3. Click on `Camera folder`and select the folder from the newest installed camera app<br>4. Take pictures with the installed camera app and with the built-in camera app<br>5. Wait 15 minutes| Only pictures taken with the newest installed camera app are enqueued and then, uploaded | P m15 t14 |  |
| Original file kept | 1. Click on `Original file will be`<br>2. Select `kept in original folder`<br>3. Close the app<br>4. Take some pictures with the camera | With the app closed, check in web or another client that the taken pictures were uploaded in 15 minutes.<br>Original files were not removed from device |P m15 t14  |  |
| Original file removed | 1. Click on `Original file will be`<br>2. Select `removed from original folder`<br>3. Close the app<br>4. Take some pictures with the camera | With the app closed, check in web or another client that the taken pictures were uploaded in 15 minutes.<br>Original files were removed from device | P m15 t14 |  |
| Only wifi| 1. Enable `Upload pictures via wifi only`<br>2. Remove WiFi from device<br>3. Using mobile connection, take pictures with the camera app<br>4. Wait 15 minutes<br>5. Enable WiFi in device<br>6. Take some pictures<br>7. Wait 15 minutes | 4. Check in uploads view that pictures are enqueued but not uploaded because condition is not fulfilled<br>7. Pictures taken in steps 3. and 6. are enqueued |  P m15 t14
| When charging | 1. Enable `Upload pictures only when charging`<br>2. Assure device is not charging<br>3. Take pictures with the camera app<br>4. Wait 15 minutes<br>5. Plug charging wire to device in<br>6. Take some pictures<br>7. Wait 15 minutes | 4. Check in uploads view that pictures are enqueued but not uploaded because condition is not fulfilled<br>7. Pictures taken in steps 3. and 6. are enqueued  |  P m15 t14 
|**Auto uploads Videos**|Preconditions:<br> 1. Enable `Video Uploads`<br>2. Set the correct `Camera folder` with the picture container from the camera app|||||
| Videos upload | 1. Close the app<br>2. Take some videos with the camera | With the app closed, check in web or another client that the taken videos were enqueued and uploaded in 15 minutes | P m15 t14 |  |
| Account | 1. With two (al least) accounts in device, click on `Account to upload videos `<br>2. Select a different account to upload videos<br>3. Close the app<br>4. Take some videos with the camera | With the app closed, check in web or another client that the taken videos were uploaded in 15 minutes to the correct account| P m15 t14 |  |
| Path oC10 | 1. Click on `Video upload path` after selecting oC10 account<br>2. Select a different folder to upload videos in the selected account<br>3. Close the app<br>4. Take some videos with the camera | With the app closed, check in web or another client that the taken videos were uploaded in 15 minutes to the correct folder | P m15 t14 |  |
| Path oCIS | 1. Click on `Video upload path` after selecting oCIS account<br>2. Select custom space<br>3. Select a different folder to upload videos in the selected account<br>4. Close the app<br>5. Take some videos with the camera | With the app closed, check in web or another client that the taken videos were uploaded in 15 minutes to the correct folder and space| P m15 t14 |  |
| Camera folder | 1. Install another camera app in the device<br>2. Click on `Video upload path`<br>3. Click on `Camera folder`and select the folder from the newest installed camera app<br>4. Take videos with the installed camera app and with the built-in camera app<br>5. Wait 15 minutes| Only videos taken with the newest installed camera app are enqueued and then, uploaded | P m15 t14 |  |
| Original file kept | 1. Click on `Original file will be`<br>2. Select `kept in original folder`<br>3. Close the app<br>4. Take some videos with the camera | With the app closed, check in web or another client that the taken videos were uploaded in 15 minutes.<br>Original files were not removed from device | P m15 t14 |  |
| Original file removed | 1. Click on `Original file will be`<br>2. Select `removed from original folder`<br>3. Close the app<br>4. Take some videos with the camera | With the app closed, check in web or another client that the taken videos were uploaded in 15 minutes.<br>Original files were removed from device | P m15 t14 |  |
| Only wifi| 1. Enable `Upload videos via wifi only`<br>2. Remove WiFi from device<br>3. Using mobile connection, take videos with the camera app<br>4. Wait 15 minutes<br>5. Enable WiFi in device<br>6. Take some videos <br>7. Wait 15 minutes | 4. Videos are not enqueued because condition is not fulfilled<br>7. Videos taken in steps 3. and 6. are enqueued |  P m15 t14
| When charging | 1. Enable `Upload pictures only when charging`<br>2. Assure device is not charging<br>3. Take videos with the camera app<br>4. Wait 15 minutes<br>5. Plug charging wire to device in<br>6. Take some videos <br>7. Wait 15 minutes | 4. Videos are not enqueued because condition is not fulfilled<br>7. Videos taken in steps 3. and 6. are enqueued  |P m15 t14  
|**Errors**|  Preconditions:<br> 1. Enable `Video Uploads` or `Photo Uploads`<br>2. Set the correct `Camera folder` with the picture container from the camera app
| Removed folder | 1. In file list, remove folder selected in `Picture upload path` section in `Auto Upload`<br>2. Take pictures/videos and wait 15 min | Removed folder is created again and contains the taken pictures/videos | P m15 t14   |  |
| Account disabled | 1. In server, disable login(oCIS) or disable account(oC10) that is selected in `Account to upload pictures/videos` section in `Auto Upload`<br>2. Take pictures/videos and wait 15 min | Error: `Credentials error` | P m15 t14  |  |
| Account removed | 1. In server, remove account that is selected in `Account to upload pictures/videos` section in `Auto Upload`<br>2. Take pictures/videos and wait 15 min | Error: `Credentials error` | P m15 t14 |
| No permissions (oC10) | 1. In oC10 server, share a folder with another user, removing edit permissions<br>2. Sharee sets that folder as target for auto uploads | Not posible, folder without writing permissions is not selectable| P m15 t14  | |
| Permissions removed (oC10) | 1. In oC10 server, share a folder with another user, grating all permissions<br>2. Sharee sets that folder as target for auto uploads<br>3. Sharing user revokes share permission (sharee can not upload anymore)<br>4. Take pictures/videos and wait 15 min | Error: `Permission error`| P m15 t14  | |
| Space dislabled (oCIS) | 1. In oCIS server, share a space with another user, granting all permissions<br>2. Sharee sets that folder as target for auto uploads<br>3. Sharing user disables the space<br>4. Take pictures/videos and wait 15 min | Error: `Conflict` | P m15  | Server returns `409 Conflict` |